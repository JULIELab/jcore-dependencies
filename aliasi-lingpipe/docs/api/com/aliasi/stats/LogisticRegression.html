<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_14) on Thu Jun 23 19:27:27 EDT 2011 -->
<TITLE>
LogisticRegression (LingPipe API)
</TITLE>

<META NAME="date" CONTENT="2011-06-23">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="LogisticRegression (LingPipe API)";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../com/aliasi/stats/DiscreteDistribution.html" title="interface in com.aliasi.stats"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../com/aliasi/stats/Model.html" title="interface in com.aliasi.stats"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?com/aliasi/stats/LogisticRegression.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="LogisticRegression.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
com.aliasi.stats</FONT>
<BR>
Class LogisticRegression</H2>
<PRE>
<A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</A>
  <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>com.aliasi.stats.LogisticRegression</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD><A HREF="../../../com/aliasi/util/Compilable.html" title="interface in com.aliasi.util">Compilable</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/io/Serializable.html?is-external=true" title="class or interface in java.io">Serializable</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>LogisticRegression</B><DT>extends <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A><DT>implements <A HREF="../../../com/aliasi/util/Compilable.html" title="interface in com.aliasi.util">Compilable</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/io/Serializable.html?is-external=true" title="class or interface in java.io">Serializable</A></DL>
</PRE>

<P>
A <code>LogisticRegression</code> instance is a multi-class vector
 classifier model generating conditional probability estimates of
 categories.  This class also provides static factory methods for
 estimating multinomial regression models using stochastic gradient
 descent (SGD) to find maximum likelihood or maximum a posteriori
 (MAP) estimates with Laplace, Gaussian, Cauchy priors on
 coefficients.

 <p>The classification package contains a class <A HREF="../../../com/aliasi/classify/LogisticRegressionClassifier.html" title="class in com.aliasi.classify"><CODE>LogisticRegressionClassifier</CODE></A> which adapts this
 class's models and estimators to act as generic classifiers given
 an instance of <A HREF="../../../com/aliasi/util/FeatureExtractor.html" title="interface in com.aliasi.util"><CODE>FeatureExtractor</CODE></A>.


 <table border="0" style="font-size:80%; width:80%; margin:0 1em 0 2em">
 <tr><td>
 <b>Also Known As (AKA)</b>

 <p>Multinomial logistic regression is also known as polytomous,
 polychotomous, or multi-class logistic regression, or just
 multilogit regression.

 <p>Binary logistic regression is an instance of a generalized
 linear model (GLM) with the logit link function.  The logit
 function is the inverse of the logistic function, and the logistic
 function is sometimes called the sigmoid function or the s-curve.

 <p>Logistic regression estimation obeys the maximum entropy
 principle, and thus logistic regression is sometimes called
 &quot;maximum entropy modeling&quot;, and the resulting classifier
 the &quot;maximum entropy classifier&quot;.

 <p>The generalization of binomial logistic regression to
 multinomial logistic regression is sometimes called a softmax or
 exponential model.

 <p>Maximum a priori (MAP) estimation with Gaussian priors is often
 referred to as &quot;ridge regression&quot;; with Laplace priors
 MAP estimation is known as the &quot;lasso&quot;.  MAP estimation
 with Gaussian, Laplace or Cauchy priors is known as parameter
 shrinkage.  Gaussian and Laplace are forms of regularized
 regression, with the Gaussian version being regularized with the
 L<sub>2</sub> norm (Euclidean distance, called the Frobenius norm
 for matrices of parameters) and the Laplace version being
 regularized with the L<sub>1</sub> norm (taxicab distance or
 Manhattan metric); other Minkowski metrics may be used for
 shrinkage.

 <p>Binary logistic regression is equivalent to a one-layer,
 single-output neural network with a logistic activation function
 trained under log loss.  This is sometimes called classification
 with a single neuron.</td></tr></table>

 <h4>Model Parameters</h4>

 A logistic regression model is a discriminitive classifier for
 vectors of fixed dimensionality.  The dimensions are often referred
 to as &quot;features&quot;. The method <A HREF="../../../com/aliasi/stats/LogisticRegression.html#numInputDimensions()"><CODE>numInputDimensions()</CODE></A> returns the number of dimensions (features)
 in the model.  Because the model is well-behaved under sparse
 vectors, the dimensionality may be returned as <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Integer.html?is-external=true#MAX_VALUE" title="class or interface in java.lang"><CODE>Integer.MAX_VALUE</CODE></A>, a common default choice for sparse vectors.


 <p>A logistic regression model also fixes the number of output
 categories.  The method <A HREF="../../../com/aliasi/stats/LogisticRegression.html#numOutcomes()"><CODE>numOutcomes()</CODE></A> returns the number
 of categories.  These outcome categories will be represented as
 integers from <code>0</code> to <code>numOutcomes()-1</code>
 inclusive.

 <p>A model is parameterized by a real-valued vector for every
 category other than the last, each of which must be of the same
 dimensionality as the model's input feature dimensionality.  The
 constructor <A HREF="../../../com/aliasi/stats/LogisticRegression.html#LogisticRegression(com.aliasi.matrix.Vector[])"><CODE>LogisticRegression(Vector[])</CODE></A> takes an array of
 <A HREF="../../../com/aliasi/matrix/Vector.html" title="interface in com.aliasi.matrix"><CODE>Vector</CODE></A> objects, which may be dense or sparse, but must all
 be of the same dimensionality.


 <h4>Likelihood</h4>

 <p>The likelihood of a given output category <code>k &lt;
 numOutcomes()</code> given an input vector <code>x</code> of
 dimensionality <code>numFeatures()</code> is given by:

 <blockquote><pre>
 p(c | x, &beta;) = exp(&beta;<sub>k</sub> * x)  / Z(x)   if c &lt; numOutcomes()-1

               1 / Z(x)              if c = numOutcomes()-1</pre></blockquote>

 where <code>&beta;<sub>k</sub> * x</code> is vector dot (or inner)
 product:

 <blockquote><pre>
 &beta;<sub>k</sub> * x = <big><big><big>&Sigma;</big></big></big><sub>i &lt; numDimensions()</sub> &beta;<sub>k,i</sub> * x<sub>i</sub></pre></blockquote>

 and where the normalizing denominator, called the partition function,
 is:

 <blockquote><pre>
 Z(x) = 1 + <big><big><big>&Sigma;</big></big></big><sub><sub>k &lt; numOutcomes()-1</sub></sub> exp(&beta;<sub>k</sub> * x)</pre></blockquote>


 <h4>Error and Gradient</h4>

 This class computes maximum a posteriori parameter values given a
 sequence of training pairs <code>(x,c)</code> and a prior, which
 must be an instance of <A HREF="../../../com/aliasi/stats/RegressionPrior.html" title="class in com.aliasi.stats"><CODE>RegressionPrior</CODE></A>.  The error function
 is just the negative log likelihood and log prior:

 <blockquote><pre>
 Err(D,&beta;) = -<big>(</big> log<sub>2</sub> p(&beta;|&sigma;<sup>2</sup>) + <big><big><big>&Sigma;</big></big></big><sub>{(x,c') in D}</sub> log<sub>2</sub> p(c'|x,&beta;)<big>)</big></pre></blockquote>

 where <code>p(&beta;|&sigma;<sub>2</sub>)</code> is the likelihood of the parameters
 <code>&beta;</code> in the prior, and <code>p(c|x,&beta;)</code> is
 the probability of category <code>c</code> given input <code>x</code>
 and parameters <code>&beta;</code>.

 <p>The maximum a posteriori estimate is such that the gradient
 (vector of partial derivatives of parameters) is zero.  If the data
 is not linearly separable, a maximum likelihood solution must
 exist.  If the data is not linearly separable and none of the data
 dimensions is colinear, the solution will be unique.  If there is
 an informative Cauchy, Gaussian or Laplace prior, there will be a
 unique MAP solution even in the face of linear separability or
 colinear dimensions.  Proofs of solution exists require showing the
 matrix of second partial derivatives of the error with respect to
 pairs of parameters, is positive semi-definite; if it is positive
 definite, the error is strictly concave and the MAP solution is
 unique.

 <p>The gradient
 for parameter vector <code>&beta;<sub>c</sub></code> for
 outcome <code>c &lt; k-1</code> is:

 <blockquote><pre>
 grad(Err(D,&beta;<sub>c</sub>))
 = &part;Err(D,&beta;) / &part;&beta;<sub>c</sub>
 = &part;(- log p(&beta;|&sigma;<sup>2</sup>)) / &part;&beta;<sub>c</sub>
   + &part;( - <big><big>&Sigma;</big></big><sub>{(x,c') in D}</sub> log p(c' | x, &beta;))</pre></blockquote>

 where the gradient of the priors are described in the
 class documentation for <A HREF="../../../com/aliasi/stats/RegressionPrior.html" title="class in com.aliasi.stats"><CODE>RegressionPrior</CODE></A>, and the
 gradient of the likelihood function is:.

 <blockquote><pre>
 &part;(-<big><big>&Sigma;</big></big><sub>{(x,c') in D}</sub> log p(c' | x, &beta;)) / &part;&beta;<sub>c</sub>
 =  - <big><big>&Sigma;</big></big><sub>{(x,c') in D}</sub> &part; log p(c' | x, &beta;))  /&part;&beta;<sub>c</sub>
 =  - <big><big>&Sigma;</big></big><sub>{(x,c') in D}</sub> x * (p(c' | x, &beta;) - I(c = c'))</pre></blockquote>

 where the indicator function <code>I(c=c')</code> is equal to 1 if
 <code>c=c'</code> and equal to 0 otherwise.


 <h4>Intercept Term</h4>

 It is conventional to assume that inputs have their first dimension
 reserved for the constant <code>1</code>, which makes the
 parameters <code>&beta;<sub>c,0</sub></code> intercepts.  The priors
 allow the intercept to be given an uninformative prior even if the
 other dimensions have informative priors.

 <h4>Feature Normalization</h4>

 It is also common to convert inputs to z-scores in logistic
 regression.  The z-score is computed given the mean and deviation
 of each dimension.  The problem with centering (subtracting the mean
 from each value) is that it destroys sparsity.  We recommend not
 centering and using an intercept term with an uninformative prior.

 <p>Variance normalization can be achieved by setting the variance
 prior parameter independently for each dimension.


 <h4>Non-Linear and Interaction Features</h4>

 It is common in logistic regression to include derived features
 which represent non-linear combinations of other input features.
 Typically, this is done through multiplication.  For instance, if
 the output is a quadratic function of an input dimension
 <code>i</code>, then in addition to the raw value
 <code>x<sub>i</sub></code>, anotehr feature <code>j</code> may be
 introduced with value <code>x<sub>i</sub><sup>2</sup></code>.

 <p>Similarly, interaction terms are often added for features
 <code>x<sub>i</sub></code> and <code>x<sub>j</sub></code>,
 with a new feature <code>x<sub>k</sub></code> being defined
 with value <code>x<sub>i</sub> <code>x<sub>j</sub></code>.

 <p>The resulting model is linear in the derived features, but
 will no longer be linear in the original features.


 <h4>Stochastic Gradient Descent</h4>

 <p>This class estimates logistic regression models using stochastic
 gradient descent (SGD).  The SGD method runs through the data one
 or more times, considering one training case at a time, adjusting
 the parameters along some multiple of the contribution to the gradient
 of the error for that case.

 <p>With informative priors, the search space
 is strictly concave, and there will be a unique solution.  In cases
 of linear dependence between dimensions or in separable data,
 maximum likelihood estimation may diverge.

 <p>The basic algorithm is:

 <blockquote><pre>
 &beta; = 0;
 for (epoch = 0; epoch &lt; maxEpochs; ++epoch)
     for training case (x,c') in D
         for category c &lt; numOutcomes-1
             &beta;<sub>c</sub> -= learningRate(epoch) * grad(Err(x,c,c',&beta;,&sigma;<sup>2</sup>))
     if (epoch &gt; minEpochs &amp;&amp; converged)
         return &beta;</pre></blockquote>

 where we discuss the learning rate and convergence conditions
 in the next section.  The gradient of the error is described
 above, and the gradient contribution of the prior and its
 parameters <code>&sigma;</code> are described in the class
 documentation for <A HREF="../../../com/aliasi/stats/RegressionPrior.html" title="class in com.aliasi.stats"><CODE>RegressionPrior</CODE></A>.  Note that the error
 gradient must be divided by the number of training cases to
 get the incremental contribution of the prior gradient.

 The actual algorithm uses a lazy form of updating the contribution
 of the gradient of the prior.  The result is an algorithm that
 handles sparse input data touching only the non-zero dimensions of
 inputs during parameter updates.

 <h4>Learning Parameters</h4>

 In addition to the model parameters (including priors) and training
 data (input vectors and reference categories), the regression
 estimation method also requires four parameters that control
 search.  The simplest search parameters are the minimum and maximum
 epoch parameters, which control the number of epochs used for
 optimzation.

 <p>The argument <code>minImprovement</code> determines how much
 improvement in training data and model log likelihood under the
 current model is necessary to go onto the next epoch.  This is
 measured relatively, with the algorithm stopping when the current
 epoch's error <code>err</code> is relatively close to the previous
 epoch's error, <code>errLast</code>:

 <blockquote><pre>
 abs(err - errLast)/(abs(err) + abs(errLast)) &lt; minImprovement</pre></blockquote>

 Setting this to a low value will lead to slow, but accurate
 coefficient estimates.

 <p>Finally, the search parameters include an instance of
 <A HREF="../../../com/aliasi/stats/AnnealingSchedule.html" title="class in com.aliasi.stats"><CODE>AnnealingSchedule</CODE></A> which impelements the <code>learningRate(epoch)</code>
 method.  See that method for concrete implementations, including
 a standard inverse epoch annealing and exponential decay annealing.

 <h4>Blocked Updates</h4>

 The implementation of stochastic gradient descent used in this
 class for fitting a logistic regression model calculates the
 likelihoods for an entire block of examples at once without
 changing the model parameters.  The parameters are then updated for
 the entire block at once.  

 <p>The last block may be smaller than the others, but it will
 be treated the same way.  First its classifications are computed,
 then the gradient updates are made, then the prior updates.

 <p>Larger block sizes tend to lead to more robust fitting, but
 may be slower to converge in terms of number of epochs.

 <p>In fitting models with priors, large block sizes will cause
 each epoch to run faster because the dense operation of adjusting
 for priors is performed less frequently.

 <p>If the block size is set to the corpus size, gradient descent
 reduces to conjugate gradient descent, although step sizes will
 still be calculated with the learning rate, not by a line search
 along the gradient direction.


 <h4>Serialization and Compilation</h4>

 For convenience, this class implements both the <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/io/Serializable.html?is-external=true" title="class or interface in java.io"><CODE>Serializable</CODE></A>
 and <A HREF="../../../com/aliasi/util/Compilable.html" title="interface in com.aliasi.util"><CODE>Compilable</CODE></A> interfaces.  Serializing or compiling
 a logistic regression model has the same effect.  The model
 read back in from its serialized state will be an instance of
 this class, <A HREF="../../../com/aliasi/stats/LogisticRegression.html" title="class in com.aliasi.stats"><CODE>LogisticRegression</CODE></A>.

 <h4>References</h4>

 Logistic regression is discussed in most machine learning and
 statistics textbooks.  These three machine learning textbooks all
 introduce some form of stochastic gradient descent and logistic
 regression (often not together, and often under different names as
 listed in the AKA section above):

 <ul>

 <li>MacKay, David. 2003. <a href="http://www.inference.phy.cam.ac.uk/mackay/itprnn/book.html"><i>Information Theory, Inference, and Learning Algorithms</i></a> (includes free download links).
 Cambridge University Press.

 <li>Hastie, Trevor, Robert Tibshirani, and Jerome Friedman. 2001.
 <i><a href="http://www-stat.stanford.edu/~tibs/ElemStatLearn/">Elements of Statistical Learning</a></i>.
 Springer.</li>

 <li>Bishop, Christopher M. 2006. <a href="http://research.microsoft.com/~cmbishop/PRML/">Pattern Recognition and Machine Learning</a>.
 Springer.</li>

 </ul>

 An introduction to traditional statistical modeling with logistic
 regression may be found in:

 <ul>
 <li>Gelman, Andrew and Jennnifer Hill.  2007.  <a href="http://www.stat.columbia.edu/~gelman/arm/">Data Analysis Using Regression and Multilevel/Hierarchical Models</a>. Cambridge University Press.
 </ul>

 A discussion of text classification using regression that evaluates
 with respect to support vector machines (SVMs) and considers
 informative Laplace and Gaussian priors varying by dimension (which
 this class supports), see:

 <ul>
 <li>Genkin, Alexander, David D. Lewis, and David Madigan. 2004.
 <a href="http://www.stat.columbia.edu/~gelman/stuff_for_blog/madigan.pdf">Large-Scale Bayesian Logistic Regression for Text Categorization</a>.
 Rutgers University Technical Report.
 (<a href="http://stat.rutgers.edu/~madigan/PAPERS/techno-06-09-18.pdf">alternate download</a>).
 </li>
 </ul>
<P>

<P>
<DL>
<DT><B>Since:</B></DT>
  <DD>LingPipe3.5</DD>
<DT><B>Version:</B></DT>
  <DD>4.0.1</DD>
<DT><B>Author:</B></DT>
  <DD>Bob Carpenter, Mike Ross</DD>
<DT><B>See Also:</B><DD><A HREF="../../../serialized-form.html#com.aliasi.stats.LogisticRegression">Serialized Form</A></DL>
<HR>

<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../com/aliasi/stats/LogisticRegression.html#LogisticRegression(com.aliasi.matrix.Vector)">LogisticRegression</A></B>(<A HREF="../../../com/aliasi/matrix/Vector.html" title="interface in com.aliasi.matrix">Vector</A>&nbsp;weightVector)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Construct a binomial logistic regression model with the
 specified parameter vector.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../com/aliasi/stats/LogisticRegression.html#LogisticRegression(com.aliasi.matrix.Vector[])">LogisticRegression</A></B>(<A HREF="../../../com/aliasi/matrix/Vector.html" title="interface in com.aliasi.matrix">Vector</A>[]&nbsp;weightVectors)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Construct a multinomial logistic regression model with
 the specified weight vectors.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;double[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/aliasi/stats/LogisticRegression.html#classify(com.aliasi.matrix.Vector)">classify</A></B>(<A HREF="../../../com/aliasi/matrix/Vector.html" title="interface in com.aliasi.matrix">Vector</A>&nbsp;x)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns an array of conditional probabilities indexed by
 outcomes for the specified input vector.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/aliasi/stats/LogisticRegression.html#classify(com.aliasi.matrix.Vector, double[])">classify</A></B>(<A HREF="../../../com/aliasi/matrix/Vector.html" title="interface in com.aliasi.matrix">Vector</A>&nbsp;x,
         double[]&nbsp;ysHat)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Fills the specified array with the conditional probabilities
 indexed by outcomes for the specified input vector.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/aliasi/stats/LogisticRegression.html#compileTo(java.io.ObjectOutput)">compileTo</A></B>(<A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/io/ObjectOutput.html?is-external=true" title="class or interface in java.io">ObjectOutput</A>&nbsp;out)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Compiles this model to the specified object output.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../../../com/aliasi/stats/LogisticRegression.html" title="class in com.aliasi.stats">LogisticRegression</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/aliasi/stats/LogisticRegression.html#estimate(com.aliasi.matrix.Vector[], int[], com.aliasi.stats.RegressionPrior, com.aliasi.stats.AnnealingSchedule, com.aliasi.io.Reporter, double, int, int)">estimate</A></B>(<A HREF="../../../com/aliasi/matrix/Vector.html" title="interface in com.aliasi.matrix">Vector</A>[]&nbsp;xs,
         int[]&nbsp;cs,
         <A HREF="../../../com/aliasi/stats/RegressionPrior.html" title="class in com.aliasi.stats">RegressionPrior</A>&nbsp;prior,
         <A HREF="../../../com/aliasi/stats/AnnealingSchedule.html" title="class in com.aliasi.stats">AnnealingSchedule</A>&nbsp;annealingSchedule,
         <A HREF="../../../com/aliasi/io/Reporter.html" title="class in com.aliasi.io">Reporter</A>&nbsp;reporter,
         double&nbsp;minImprovement,
         int&nbsp;minEpochs,
         int&nbsp;maxEpochs)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Estimate a logistic regression model from the specified input
 data using the specified Gaussian prior, initial learning rate
 and annealing rate, the minimum improvement per epoch, the
 minimum and maximum number of estimation epochs, and a
 reporter.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../../../com/aliasi/stats/LogisticRegression.html" title="class in com.aliasi.stats">LogisticRegression</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/aliasi/stats/LogisticRegression.html#estimate(com.aliasi.matrix.Vector[], int[], com.aliasi.stats.RegressionPrior, int, com.aliasi.stats.LogisticRegression, com.aliasi.stats.AnnealingSchedule, double, int, int, int, com.aliasi.corpus.ObjectHandler, com.aliasi.io.Reporter)">estimate</A></B>(<A HREF="../../../com/aliasi/matrix/Vector.html" title="interface in com.aliasi.matrix">Vector</A>[]&nbsp;xs,
         int[]&nbsp;cs,
         <A HREF="../../../com/aliasi/stats/RegressionPrior.html" title="class in com.aliasi.stats">RegressionPrior</A>&nbsp;prior,
         int&nbsp;blockSize,
         <A HREF="../../../com/aliasi/stats/LogisticRegression.html" title="class in com.aliasi.stats">LogisticRegression</A>&nbsp;hotStart,
         <A HREF="../../../com/aliasi/stats/AnnealingSchedule.html" title="class in com.aliasi.stats">AnnealingSchedule</A>&nbsp;annealingSchedule,
         double&nbsp;minImprovement,
         int&nbsp;rollingAverageSize,
         int&nbsp;minEpochs,
         int&nbsp;maxEpochs,
         <A HREF="../../../com/aliasi/corpus/ObjectHandler.html" title="interface in com.aliasi.corpus">ObjectHandler</A>&lt;<A HREF="../../../com/aliasi/stats/LogisticRegression.html" title="class in com.aliasi.stats">LogisticRegression</A>&gt;&nbsp;handler,
         <A HREF="../../../com/aliasi/io/Reporter.html" title="class in com.aliasi.io">Reporter</A>&nbsp;reporter)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Estimate a logistic regression model from the specified input
 data using the specified Gaussian prior, initial learning rate
 and annealing rate, the minimum improvement per epoch, the
 minimum and maximum number of estimation epochs, and a
 reporter.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;double</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/aliasi/stats/LogisticRegression.html#log2Likelihood(com.aliasi.matrix.Vector[], int[], com.aliasi.stats.LogisticRegression)">log2Likelihood</A></B>(<A HREF="../../../com/aliasi/matrix/Vector.html" title="interface in com.aliasi.matrix">Vector</A>[]&nbsp;inputs,
               int[]&nbsp;cats,
               <A HREF="../../../com/aliasi/stats/LogisticRegression.html" title="class in com.aliasi.stats">LogisticRegression</A>&nbsp;regression)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the log (base 2) likelihood of the specified inputs
 with the specified categories using the specified regression
 model.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/aliasi/stats/LogisticRegression.html#numInputDimensions()">numInputDimensions</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the dimensionality of inputs for this logistic
 regression model.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/aliasi/stats/LogisticRegression.html#numOutcomes()">numOutcomes</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the number of outcomes for this logistic regression
 model.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../com/aliasi/matrix/Vector.html" title="interface in com.aliasi.matrix">Vector</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/aliasi/stats/LogisticRegression.html#weightVectors()">weightVectors</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns an array of views of the weight vectors used for this
 regression model.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.<A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#wait(long, int)" title="class or interface in java.lang">wait</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="LogisticRegression(com.aliasi.matrix.Vector[])"><!-- --></A><H3>
LogisticRegression</H3>
<PRE>
public <B>LogisticRegression</B>(<A HREF="../../../com/aliasi/matrix/Vector.html" title="interface in com.aliasi.matrix">Vector</A>[]&nbsp;weightVectors)</PRE>
<DL>
<DD>Construct a multinomial logistic regression model with
 the specified weight vectors.  With <code>k-1</code>
 weight vectors, the result is a multinomial classifier
 with <code>k</code> outcomes.

 <p>The weight vectors are stored rather than copied, so
 changes to them will affect this class.

<p>See the class definition above for more information on
logistic regression.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>weightVectors</CODE> - Weight vectors definining this regression
 model.
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</A></CODE> - If the array of weight vectors
 does not have at least one element or if there are two weight
 vectors with different numbers of dimensions.</DL>
</DL>
<HR>

<A NAME="LogisticRegression(com.aliasi.matrix.Vector)"><!-- --></A><H3>
LogisticRegression</H3>
<PRE>
public <B>LogisticRegression</B>(<A HREF="../../../com/aliasi/matrix/Vector.html" title="interface in com.aliasi.matrix">Vector</A>&nbsp;weightVector)</PRE>
<DL>
<DD>Construct a binomial logistic regression model with the
 specified parameter vector.  See the class definition above
 for more information on logistic regression.

 <p>The weight vector is stored rather than copied, so 
 changes to it will affect this class.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>weightVector</CODE> - The weights of features defining this
 model.</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="numInputDimensions()"><!-- --></A><H3>
numInputDimensions</H3>
<PRE>
public int <B>numInputDimensions</B>()</PRE>
<DL>
<DD>Returns the dimensionality of inputs for this logistic
 regression model.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>The number of dimensions for this model.</DL>
</DD>
</DL>
<HR>

<A NAME="numOutcomes()"><!-- --></A><H3>
numOutcomes</H3>
<PRE>
public int <B>numOutcomes</B>()</PRE>
<DL>
<DD>Returns the number of outcomes for this logistic regression
 model.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>The number of outcomes for this model.</DL>
</DD>
</DL>
<HR>

<A NAME="weightVectors()"><!-- --></A><H3>
weightVectors</H3>
<PRE>
public <A HREF="../../../com/aliasi/matrix/Vector.html" title="interface in com.aliasi.matrix">Vector</A>[] <B>weightVectors</B>()</PRE>
<DL>
<DD>Returns an array of views of the weight vectors used for this
 regression model.  The returned weight vectors are immutable
 views of the underlying vectors used by this model, so will
 change if the vectors making up this model change.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>An array of views of the weight vectors for this model.</DL>
</DD>
</DL>
<HR>

<A NAME="classify(com.aliasi.matrix.Vector)"><!-- --></A><H3>
classify</H3>
<PRE>
public double[] <B>classify</B>(<A HREF="../../../com/aliasi/matrix/Vector.html" title="interface in com.aliasi.matrix">Vector</A>&nbsp;x)</PRE>
<DL>
<DD>Returns an array of conditional probabilities indexed by
 outcomes for the specified input vector.  The resulting array
 has a value for index <code>i</code> that is equal to the
 probability of the outcome <code>i</code> for the specified
 input.  The sum of the returned values will be 1.0 (modulo
 arithmetic precision).

 <p>See the class definition above for more information on
 how the conditional probabilities are computed.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>x</CODE> - The input vector.
<DT><B>Returns:</B><DD>The array of conditional probabilities of
 outcomes.
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</A></CODE> - If the specified vector is not
 the same dimensionality as this logistic regression instance.</DL>
</DD>
</DL>
<HR>

<A NAME="classify(com.aliasi.matrix.Vector, double[])"><!-- --></A><H3>
classify</H3>
<PRE>
public void <B>classify</B>(<A HREF="../../../com/aliasi/matrix/Vector.html" title="interface in com.aliasi.matrix">Vector</A>&nbsp;x,
                     double[]&nbsp;ysHat)</PRE>
<DL>
<DD>Fills the specified array with the conditional probabilities
 indexed by outcomes for the specified input vector.

 <p>The resulting array has a value for index <code>i</code>
 that is equal to the probability of the outcome <code>i</code>
 for the specified input.  The sum of the returned values will
 be 1.0 (modulo arithmetic precision).  

 <p>See the class definition above for more information on
 how the conditional probabilities are computed.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>x</CODE> - The input vector.<DD><CODE>ysHat</CODE> - Array into which conditional probabilities are written.
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</A></CODE> - If the specified vector is not
 the same dimensionality as this logistic regression instance.</DL>
</DD>
</DL>
<HR>

<A NAME="compileTo(java.io.ObjectOutput)"><!-- --></A><H3>
compileTo</H3>
<PRE>
public void <B>compileTo</B>(<A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/io/ObjectOutput.html?is-external=true" title="class or interface in java.io">ObjectOutput</A>&nbsp;out)
               throws <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</A></PRE>
<DL>
<DD>Compiles this model to the specified object output.  The
 compiled model, when read back in, will remain an instance of
 this class, <A HREF="../../../com/aliasi/stats/LogisticRegression.html" title="class in com.aliasi.stats"><CODE>LogisticRegression</CODE></A>.

 <p>Compilation does the same thing as serialization.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../com/aliasi/util/Compilable.html#compileTo(java.io.ObjectOutput)">compileTo</A></CODE> in interface <CODE><A HREF="../../../com/aliasi/util/Compilable.html" title="interface in com.aliasi.util">Compilable</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>out</CODE> - Object output to which this model is compiled.
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</A></CODE> - If there is an underlying I/O error during
 serialization.</DL>
</DD>
</DL>
<HR>

<A NAME="estimate(com.aliasi.matrix.Vector[], int[], com.aliasi.stats.RegressionPrior, com.aliasi.stats.AnnealingSchedule, com.aliasi.io.Reporter, double, int, int)"><!-- --></A><H3>
estimate</H3>
<PRE>
public static <A HREF="../../../com/aliasi/stats/LogisticRegression.html" title="class in com.aliasi.stats">LogisticRegression</A> <B>estimate</B>(<A HREF="../../../com/aliasi/matrix/Vector.html" title="interface in com.aliasi.matrix">Vector</A>[]&nbsp;xs,
                                          int[]&nbsp;cs,
                                          <A HREF="../../../com/aliasi/stats/RegressionPrior.html" title="class in com.aliasi.stats">RegressionPrior</A>&nbsp;prior,
                                          <A HREF="../../../com/aliasi/stats/AnnealingSchedule.html" title="class in com.aliasi.stats">AnnealingSchedule</A>&nbsp;annealingSchedule,
                                          <A HREF="../../../com/aliasi/io/Reporter.html" title="class in com.aliasi.io">Reporter</A>&nbsp;reporter,
                                          double&nbsp;minImprovement,
                                          int&nbsp;minEpochs,
                                          int&nbsp;maxEpochs)</PRE>
<DL>
<DD>Estimate a logistic regression model from the specified input
 data using the specified Gaussian prior, initial learning rate
 and annealing rate, the minimum improvement per epoch, the
 minimum and maximum number of estimation epochs, and a
 reporter.  The block size defaults to the number of examples
 divided by 50 (or 1 if the division results in 0).

 <p>See the class documentation above for more information on
 logistic regression and the stochastic gradient descent algorithm
 used to implement this method.

 <p><b>Reporting:</b> Reports at the debug level provide
 epoch-by-epoch feedback.  Reports at the info level indicate
 inputs and major milestones in the algorithm.  Reports at the
 fatal levels are for thrown exceptions.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>xs</CODE> - Input vectors indexed by training case.<DD><CODE>cs</CODE> - Output categories indexed by training case.<DD><CODE>prior</CODE> - The prior to be used for regression.<DD><CODE>annealingSchedule</CODE> - Class to compute learning rate for each epoch.<DD><CODE>minImprovement</CODE> - The minimum relative improvement in
 log likelihood for the corpus to continue to another epoch.<DD><CODE>minEpochs</CODE> - Minimum number of epochs.<DD><CODE>maxEpochs</CODE> - Maximum number of epochs.<DD><CODE>reporter</CODE> - Reporter to which progress reports are written, or
 <code>null</code> if no progress reports are needed.
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</A></CODE> - If the set of input vectors
 does not contain at least one instance, if the number of output
 categories isn't the same as the input categories, if two input
 vectors have different dimensions, or if the prior has a
 different number of dimensions than the instances.</DL>
</DD>
</DL>
<HR>

<A NAME="estimate(com.aliasi.matrix.Vector[], int[], com.aliasi.stats.RegressionPrior, int, com.aliasi.stats.LogisticRegression, com.aliasi.stats.AnnealingSchedule, double, int, int, int, com.aliasi.corpus.ObjectHandler, com.aliasi.io.Reporter)"><!-- --></A><H3>
estimate</H3>
<PRE>
public static <A HREF="../../../com/aliasi/stats/LogisticRegression.html" title="class in com.aliasi.stats">LogisticRegression</A> <B>estimate</B>(<A HREF="../../../com/aliasi/matrix/Vector.html" title="interface in com.aliasi.matrix">Vector</A>[]&nbsp;xs,
                                          int[]&nbsp;cs,
                                          <A HREF="../../../com/aliasi/stats/RegressionPrior.html" title="class in com.aliasi.stats">RegressionPrior</A>&nbsp;prior,
                                          int&nbsp;blockSize,
                                          <A HREF="../../../com/aliasi/stats/LogisticRegression.html" title="class in com.aliasi.stats">LogisticRegression</A>&nbsp;hotStart,
                                          <A HREF="../../../com/aliasi/stats/AnnealingSchedule.html" title="class in com.aliasi.stats">AnnealingSchedule</A>&nbsp;annealingSchedule,
                                          double&nbsp;minImprovement,
                                          int&nbsp;rollingAverageSize,
                                          int&nbsp;minEpochs,
                                          int&nbsp;maxEpochs,
                                          <A HREF="../../../com/aliasi/corpus/ObjectHandler.html" title="interface in com.aliasi.corpus">ObjectHandler</A>&lt;<A HREF="../../../com/aliasi/stats/LogisticRegression.html" title="class in com.aliasi.stats">LogisticRegression</A>&gt;&nbsp;handler,
                                          <A HREF="../../../com/aliasi/io/Reporter.html" title="class in com.aliasi.io">Reporter</A>&nbsp;reporter)</PRE>
<DL>
<DD>Estimate a logistic regression model from the specified input
 data using the specified Gaussian prior, initial learning rate
 and annealing rate, the minimum improvement per epoch, the
 minimum and maximum number of estimation epochs, and a
 reporter.

 <p>See the class documentation above for more information on
 logistic regression and the stochastic gradient descent algorithm
 used to implement this method.

 <p><b>Reporting:</b> Reports at the debug level provide
 epoch-by-epoch feedback.  Reports at the info level indicate
 inputs and major milestones in the algorithm.  Reports at the
 fatal levels are for thrown exceptions.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>xs</CODE> - Input vectors indexed by training case.<DD><CODE>cs</CODE> - Output categories indexed by training case.<DD><CODE>prior</CODE> - The prior to be used for regression.<DD><CODE>blockSize</CODE> - Number of examples whose gradient is
 computed before updating coefficients.<DD><CODE>hotStart</CODE> - Logistic regression from which to retrieve
 initial weights or null to use zero vectors.<DD><CODE>annealingSchedule</CODE> - Class to compute learning rate for each epoch.<DD><CODE>minImprovement</CODE> - The minimum relative improvement in
 log likelihood for the corpus to continue to another epoch.<DD><CODE>minEpochs</CODE> - Minimum number of epochs.<DD><CODE>maxEpochs</CODE> - Maximum number of epochs.<DD><CODE>handler</CODE> - Handler for intermediate regression results.<DD><CODE>reporter</CODE> - Reporter to which progress reports are written, or
 <code>null</code> if no progress reports are needed.
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</A></CODE> - If the set of input vectors
 does not contain at least one instance, if the number of output
 categories isn't the same as the input categories, if two input
 vectors have different dimensions, or if the prior has a
 different number of dimensions than the instances.</DL>
</DD>
</DL>
<HR>

<A NAME="log2Likelihood(com.aliasi.matrix.Vector[], int[], com.aliasi.stats.LogisticRegression)"><!-- --></A><H3>
log2Likelihood</H3>
<PRE>
public static double <B>log2Likelihood</B>(<A HREF="../../../com/aliasi/matrix/Vector.html" title="interface in com.aliasi.matrix">Vector</A>[]&nbsp;inputs,
                                    int[]&nbsp;cats,
                                    <A HREF="../../../com/aliasi/stats/LogisticRegression.html" title="class in com.aliasi.stats">LogisticRegression</A>&nbsp;regression)</PRE>
<DL>
<DD>Returns the log (base 2) likelihood of the specified inputs
 with the specified categories using the specified regression
 model.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>inputs</CODE> - Input vectors.<DD><CODE>cats</CODE> - Categories for input vectors.<DD><CODE>regression</CODE> - Model to use for computing likelihood.
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</A></CODE> - If the inputs and categories
 are not the same length.</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../com/aliasi/stats/DiscreteDistribution.html" title="interface in com.aliasi.stats"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../com/aliasi/stats/Model.html" title="interface in com.aliasi.stats"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?com/aliasi/stats/LogisticRegression.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="LogisticRegression.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
